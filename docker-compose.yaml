services:
  signal-cli-rest-api:
    image: "bbernhard/signal-cli-rest-api:0.90"
    ports:
      - "8080:8080"
    volumes:
      - "$HOME/.local/share/signal-api:/home/.local/share/signal-cli"
    environment:
      - MODE=json-rpc
      - AUTO_RECEIVE_SCHEDULE_SEND_READ_RECEIPTS=true
    restart: always
  signalblast:
    image: "eradorta/signalblast:$DOCKER_TAG"
    build:
      network: "host"
      args:
        SIGNALBLAST_VERSION: $SIGNALBLAST_VERSION
    network_mode: "host"
    volumes:
      - "$HOME/.local/share/signal-api/:/home/user/.local/share/signal-api/"
      - "./signalblast_data:/home/user/signalblast/signalblast-$SIGNALBLAST_VERSION/src/signalblast/data/"
    environment:
      - SIGNALBLAST_PHONE_NUMBER=$SIGNALBLAST_PHONE_NUMBER
      - SIGNALBLAST_PASSWORD=$SIGNALBLAST_PASSWORD
      - SIGNALBLAST_HEALTHCHECK_RECEIVER=$SIGNALBLAST_HEALTHCHECK_RECEIVER
    depends_on:
      signal-cli-rest-api:
        condition: service_healthy
    restart: always
